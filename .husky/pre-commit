#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Bo CLI Pre-commit Quality Gates
echo "ğŸ” Running pre-commit quality checks..."

# 1. Type Check
echo "\nğŸ“ TypeScript type checking..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ Type check failed! Fix errors before committing."
  exit 1
fi

# 2. Linting
echo "\nğŸ”§ ESLint checking..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Linting failed! Run 'npm run lint:fix' to auto-fix or fix manually."
  exit 1
fi

# 3. Run tests (fast ones only)
echo "\nğŸ§ª Running tests..."
npm test
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed! Fix test failures before committing."
  exit 1
fi

# 4. Build check
echo "\nğŸ—ï¸  Build check..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Fix build errors before committing."
  exit 1
fi

echo "\nâœ… All pre-commit checks passed!"
echo "ğŸ“¦ Ready to commit.\n"
